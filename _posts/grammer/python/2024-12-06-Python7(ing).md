---
title: `%load_ext autoreload` and `%autoreload 2`
description: Let's check the results immediately without restarting the kernel. 
author: DS2Man
date: 2124-12-05 11:00:00 +0000
categories: [Grammer, Python]
tags:
  - Python
  - Grammer
math: true
pin: true
---

**PyInstallerë¡œ ë°”ì´ë„ˆë¦¬ë¡œ íŒ¨í‚¤ì§•**

Python ì½”ë“œë¥¼ `.exe` ë˜ëŠ” ë¦¬ëˆ…ìŠ¤ ì‹¤í–‰ íŒŒì¼ë¡œ ë§Œë“¤ì–´ ì†ŒìŠ¤ì½”ë“œë¥¼ ìˆ¨ê¸¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ğŸ”§ ë°©ë²•:

bash

ë³µì‚¬í¸ì§‘

`pip install pyinstaller pyinstaller --onefile main.py`

`dist/main` ì‹¤í–‰ íŒŒì¼ì´ ìƒì„±ë˜ë©°, `.py` íŒŒì¼ ì—†ì´ë„ ì‹¤í–‰ ê°€ëŠ¥.

### ğŸ’¡Dockerfile ì˜ˆì‹œ:

dockerfile

ë³µì‚¬í¸ì§‘

`FROM python:3.10-slim AS builder WORKDIR /build COPY . . RUN pip install pyinstaller RUN pyinstaller --onefile main.py  FROM python:3.10-slim WORKDIR /app COPY --from=builder /build/dist/main /app/main CMD ["./main"]`

ğŸ‘‰ **ê²°ê³¼**: `main.py` ê°™ì€ ì†ŒìŠ¤ëŠ” ë‚¨ì§€ ì•Šê³ , `/app/main` ì‹¤í–‰ íŒŒì¼ë§Œ ìˆìŒ.

---

## âœ… 2. **ì†ŒìŠ¤ì½”ë“œ ì••ì¶• í›„ ì‹¤í–‰ (zipapp ë“±)**

Pythonì—ëŠ” `.pyz` í˜•ì‹ìœ¼ë¡œ ì••ì¶•í•´ ì‹¤í–‰í•˜ëŠ” ë°©ì‹ë„ ìˆìŠµë‹ˆë‹¤.

### ë°©ë²•:

bash

ë³µì‚¬í¸ì§‘

`python -m zipapp your_project_dir -o app.pyz -p "/usr/bin/env python3"`

`.pyz` íŒŒì¼ í•˜ë‚˜ë§Œ ë³µì‚¬í•´ì„œ ì‹¤í–‰ ê°€ëŠ¥ (`python app.pyz`).

---

## âœ… 3. **ë©€í‹°ìŠ¤í…Œì´ì§€ ë¹Œë“œë¡œ ì†ŒìŠ¤ ì œê±°**

ë¹Œë“œ ì‹œì—ëŠ” ì½”ë“œë¥¼ í¬í•¨í•˜ë˜, **ìµœì¢… ì´ë¯¸ì§€ì—ëŠ” ì‹¤í–‰ íŒŒì¼ë§Œ ë‚¨ê¸°ê¸°**.

dockerfile

ë³µì‚¬í¸ì§‘

`# Stage 1: ë¹Œë“œ FROM python:3.10-slim as builder WORKDIR /app COPY . . RUN pip install pyinstaller && pyinstaller --onefile main.py  # Stage 2: ì‹¤í–‰ FROM python:3.10-slim WORKDIR /app COPY --from=builder /app/dist/main . CMD ["./main"]`

ì†ŒìŠ¤ëŠ” builder ë‹¨ê³„ì—ë§Œ ìˆê³  ìµœì¢… ì´ë¯¸ì§€ì—” ì—†ìŒ.

---

## âœ… 4. **.pyc íŒŒì¼ë§Œ ë³µì‚¬**

Python ë°”ì´íŠ¸ì½”ë“œë§Œ ë³µì‚¬í•˜ì—¬ ì‹¤í–‰ (ì•½ê°„ì˜ ë³´ì•ˆ, ì‰½ê²Œ ë””ì»´íŒŒì¼ë¨)

bash

ë³µì‚¬í¸ì§‘

`python -m compileall .`

`.pyc` íŒŒì¼ë§Œ ì»¨í…Œì´ë„ˆì— ë³µì‚¬

> â—ë‹¨ì : `.pyc`ëŠ” **ì—­ì»´íŒŒì¼ì´ ì‰¬ì›Œ ë³´ì•ˆì— ì·¨ì•½**í•©ë‹ˆë‹¤.

---

## âœ… 5. **ì†ŒìŠ¤ ë‚œë…í™”**

ì›ì‹œ ì½”ë“œë¥¼ ë‚œë…í™”í•˜ëŠ” ë„êµ¬ ì‚¬ìš© (ex: `pyarmor`, `obfuscator`)

bash

ë³µì‚¬í¸ì§‘

`pip install pyarmor pyarmor gen main.py`

ë‹¨ì : ê³ ê¸‰ ì‚¬ìš©ìëŠ” ì—¬ì „íˆ ë””ì½”ë”© ê°€ëŠ¥.

---

## ğŸ§  ì¶”ì²œ ì¡°í•©

|ëª©í‘œ|ë°©ë²•|
|---|---|
|ì‹¤í–‰ë§Œ ê°€ëŠ¥, ì†ŒìŠ¤ ì™„ì „ ì œì™¸|**PyInstaller + Multi-stage Docker**|
|ë¹ ë¥´ê²Œ ì†ŒìŠ¤ë§Œ ê°ì¶”ê¸°|`.pyc` íŒŒì¼ë§Œ ë³µì‚¬|
|ë‚œë…í™”|`pyarmor` ì‚¬ìš©|
|ì„œë²„ ë‚´ë¶€ì—ì„œë§Œ ì‹¤í–‰, ì™„ì „ ë³´í˜¸ í•„ìš” ì—†ìŒ|ë‹¨ìˆœ multi-stageë¡œ ì œê±°|

---

í•„ìš”í•˜ì‹œë©´ ê° ë°©ì‹ì— ëŒ€í•œ **ì „ì²´ Dockerfile**ë„ ë§Œë“¤ì–´ ë“œë¦´ ìˆ˜ ìˆì–´ìš”.

4o

##### ë‚˜ì˜ ë§:

â”œâ”€ai â”‚ â”œâ”€tools â”‚ â”‚ â””â”€__pycache__ â”‚ â””â”€__pycache__ â”œâ”€cache â”œâ”€commons â”‚ â””â”€__pycache__ â”œâ”€config â”œâ”€log â”œâ”€pretrained_models â”‚ â””â”€bge-m3 â”‚ â”œâ”€1_Pooling â”‚ â”œâ”€imgs â”‚ â””â”€onnx â”œâ”€prompts â”œâ”€routers â”‚ â””â”€__pycache__ â”œâ”€taks_ai â”œâ”€tasks â”‚ â””â”€__pycache__ â””â”€__pycache__ ì´ëŸ° êµ¬ì¡°ë¥¼ ê°€ì§€ê³  ìˆê³  rootì— main.pyê°€ ìˆì–´. pyinstaller --onefile main.py ë¡œ í•˜ë©´ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ íŒŒì¼ ìƒê¸°ë‹ˆ?

###### ChatGPTì˜ ë§:

ì¢‹ì€ ì§ˆë¬¸ì…ë‹ˆë‹¤. `pyinstaller --onefile main.py` ë¥¼ ë°”ë¡œ ì‹¤í–‰í•˜ë©´ **ì¼ë‹¨ ì‹¤í–‰ íŒŒì¼ì€ ìƒì„±ë˜ì§€ë§Œ**, êµ¬ì¡°ìƒ **ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ì§€ ì•Šì„ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.** ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

---

## âš ï¸ ë¬¸ì œ ë°œìƒ ê°€ëŠ¥ í¬ì¸íŠ¸

### 1. **ìƒëŒ€ ê²½ë¡œ ì‚¬ìš©**

`main.py`ê°€ ë‚´ë¶€ì ìœ¼ë¡œ `prompts/`, `config/`, `routers/` ë“± í•˜ìœ„ í´ë”ì˜ íŒŒì¼ì„ `ìƒëŒ€ ê²½ë¡œë¡œ ì ‘ê·¼`í•˜ê³  ìˆë‹¤ë©´, PyInstaller ì‹¤í–‰ íŒŒì¼ ë‚´ì—ì„œëŠ” íŒŒì¼ ì‹œìŠ¤í…œ êµ¬ì¡°ê°€ ë°”ë€Œê¸° ë•Œë¬¸ì— ê²½ë¡œ ì˜¤ë¥˜ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆì‹œ ì˜¤ë¥˜:

python

ë³µì‚¬í¸ì§‘

`open("prompts/system_prompt.yaml")  # FileNotFoundError`

âœ… í•´ê²°: ì‹¤í–‰ ì‹œ **íŒŒì¼ì„ ì‹¤ì œ íŒŒì¼ë¡œ ë¶„ë¦¬í•˜ê±°ë‚˜**, `pkgutil`, `importlib.resources`, ë˜ëŠ” `sys._MEIPASS`ë¡œ ì ‘ê·¼

---

### 2. **ì™¸ë¶€ íŒŒì¼ í¬í•¨ í•„ìš”**

PyInstallerëŠ” `.py` íŒŒì¼ë§Œ í¬í•¨í•˜ê³  `.yaml`, `.json`, `.onnx`, `.txt`, `.png` ë“±ì˜ íŒŒì¼ì€ **ìë™ìœ¼ë¡œ í¬í•¨ë˜ì§€ ì•ŠìŒ**

âœ… í•´ê²°:  
`--add-data` ì˜µì…˜ìœ¼ë¡œ ìˆ˜ë™ ì¶”ê°€

bash

ë³µì‚¬í¸ì§‘

`pyinstaller --onefile main.py \   --add-data "prompts:prompts" \   --add-data "config:config" \   --add-data "pretrained_models:pretrained_models"`

**ì£¼ì˜:** `--add-data`ëŠ” OSì— ë”°ë¼ êµ¬ë¶„ìê°€ ë‹¤ë¦„

- **Linux/Mac**: `--add-data src:dest`
    
- **Windows**: `--add-data src;dest`
    

---

### 3. **ONNXë‚˜ ëª¨ë¸ ê²½ë¡œ ë¬¸ì œ**

`pretrained_models/bge-m3` ë‚´ ëª¨ë¸ íŒŒì¼ì„ `SentenceTransformer`ë‚˜ ONNX Runtimeì—ì„œ ë¡œë“œí•˜ë ¤ê³  í•˜ë©´, ì‹¤í–‰íŒŒì¼ ì•ˆì—ì„œ ì§ì ‘ ì ‘ê·¼ì´ ì•ˆ ë©ë‹ˆë‹¤.

âœ… í•´ê²°:

- ì™¸ë¶€ ë””ë ‰í„°ë¦¬ë¡œ ë³µì‚¬í•´ì„œ `runtime`ì— ì ‘ê·¼í•˜ë„ë¡ ì„¤ê³„í•˜ê±°ë‚˜,
    
- ëª¨ë¸ì„ í•¨ê»˜ ë°°í¬í•˜ê³  ì™¸ë¶€ ê²½ë¡œë¡œ ì½ë„ë¡ êµ¬ì„±
    

---

## âœ… ìµœì†Œ ì‘ì—… ì˜ˆì‹œ (Windows ê¸°ì¤€)

bash

ë³µì‚¬í¸ì§‘

`pyinstaller --onefile main.py ^   --add-data "prompts;prompts" ^   --add-data "config;config" ^   --add-data "pretrained_models;pretrained_models" ^   --add-data "log;log"`

---

## âœ… ì‹¤í–‰ ê²½ë¡œ ì œì–´ ì½”ë“œ (main.py ì˜ˆì‹œ)

python

ë³µì‚¬í¸ì§‘

`import sys import os  def get_resource_path(relative_path):     """PyInstaller í™˜ê²½ì—ì„œ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ìš© ê²½ë¡œ ë³´ì • í•¨ìˆ˜"""     if hasattr(sys, '_MEIPASS'):         return os.path.join(sys._MEIPASS, relative_path)     return os.path.join(os.path.abspath("."), relative_path)  # ì˜ˆ: prompts/system_prompt.yaml ì½ê¸° yaml_path = get_resource_path("prompts/system_prompt.yaml")`

---

## âœ… ê²°ë¡ 

|í•­ëª©|ìƒíƒœ|
|---|---|
|ì‹¤í–‰ íŒŒì¼ ìƒì„± ì—¬ë¶€|âœ… ë¨ (`main.exe`)|
|ì •ìƒ ë™ì‘ ì—¬ë¶€|âš ï¸ ì™¸ë¶€ íŒŒì¼ ì ‘ê·¼ ì‹¤íŒ¨ ê°€ëŠ¥ì„± ë†’ìŒ|
|í•´ê²° ë°©ë²•|`--add-data`ë¡œ ë¦¬ì†ŒìŠ¤ í¬í•¨ + ì‹¤í–‰ ê²½ë¡œ ë³´ì •|