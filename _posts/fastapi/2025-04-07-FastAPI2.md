---
title: Request and Response in FastAPI
description: Let's learn request and response.
author: DS2Man
date: 2025-04-07 11:00:00 +0000
categories: [Backend, FastAPI]
tags: [Backend, FastAPI]
math: true
pin: true
---

## *What is a Request Object?*

The `Request` object in FastAPI represents the HTTP request sent by the client. It contains metadata and payload, such as:

- HTTP method (`GET`, `POST`, etc.)
- Query parameters
- Request headers
- Cookies
- Request body
- Client IP
- Path parameters
- App context (shared state)


#### *Key Attributes and Methods of `Request`*

|Attribute / Method|Description|
|---|---|
|`request.method`|HTTP method used for the request (e.g., `GET`, `POST`)|
|`request.url`|Full URL of the incoming request|
|`request.base_url`|Base URL excluding the query string|
|`request.headers`|All HTTP headers (case-insensitive dictionary)|
|`request.query_params`|Query parameters (e.g., `/item?id=123`)|
|`request.path_params`|Path parameters extracted from the route|
|`request.cookies`|Cookies included in the request|
|`request.client`|Client's IP address and port|
|`await request.body()`|Entire request body as raw bytes|
|`await request.json()`|Parsed JSON body as a dictionary|
|`request.app.state`|Shared application state (for accessing global app data)|

#### *Example - Using GET*

```python
@router.get("/request&response/case1")
async def get_request_info(request: Request):
    result = {
        "method": request.method,
        "client": request.client.host,
        "headers": dict(request.headers),
        "query": dict(request.query_params)
    }

    return result
```

```python
url = "http://127.0.0.1:7249/ds2man/basic/request&response/case1"
async with aiohttp.ClientSession(
    trust_env=True, timeout=aiohttp.ClientTimeout(total=120)
) as session:
    async with session.get(url) as response:
        data = await response.json()
        print(f"\nJSON Body:")
        print(f"type(data): {type(data)}")
        pprint(data)
```

```bash
JSON Body:
type(data): <class 'dict'>
{'client': '127.0.0.1',
 'headers': {'accept': '*/*',
             'accept-encoding': 'gzip, deflate',
             'host': '127.0.0.1:7249',
             'user-agent': 'Python/3.11 aiohttp/3.11.11'},
 'method': 'GET',
 'query': {}}
```

#### *Example - Using POST*

```python
@router.post("/request&response/case2")
async def get_request_info(request: Request):
    data = await request.json()
    result = {
        "method": request.method,
        "client": request.client.host,
        "headers": dict(request.headers),
        "query": dict(request.query_params),
        "body": data
    }

    return result
```

```python
url = "http://127.0.0.1:7249/ds2man/basic/request&response/case2"
payload = {
    "key1": "value1", 
    "key2": "value2"
}
async with aiohttp.ClientSession(
    trust_env=True, timeout=aiohttp.ClientTimeout(total=120)
) as session:
    async with session.post(url, json=payload) as response:
        data = await response.json()
        print(f"\nJSON Body:")
        print(f"type(data): {type(data)}")
        pprint(data)
```

```bash
JSON Body:
type(data): <class 'dict'>
{'body': {'key1': 'value1', 'key2': 'value2'},
 'client': '127.0.0.1',
 'headers': {'accept': '*/*',
             'accept-encoding': 'gzip, deflate',
             'content-length': '36',
             'content-type': 'application/json',
             'host': '127.0.0.1:7249',
             'user-agent': 'Python/3.11 aiohttp/3.11.11'},
 'method': 'POST',
 'query': {}}
```

## *What is a Response Object?*

A `Response` object defines what the API sends back to the client. FastAPI handles most responses automatically by serializing the returned values, but for more control (e.g., setting custom headers, content type, or cookies), you can use the `Response` object directly.

FastAPI uses `JSONResponse` by default to automatically convert responses into JSON. Additionally, it provides other response classes such as `HTMLResponse` and `RedirectResponse`, which will be covered in detail in a later post.

There are several types of responses:
- `JSONResponse` (default)    
- `HTMLResponse`    
- `PlainTextResponse`    
- `StreamingResponse`    
- `RedirectResponse`    
- `FileResponse`

```python
@router.get("/request&response/case3")
def set_custom_header(response: Response):
    response.headers["X-Custom-Header"] = "FastAPI Rocks"
    result = {
        "message": "Header set"
    }

    return result
```

```python
url = "http://127.0.0.1:7249/ds2man/basic/request&response/case3"
payload = {
    "key1": "value1", 
    "key2": "value2"
}
async with aiohttp.ClientSession(
    trust_env=True, timeout=aiohttp.ClientTimeout(total=120)
) as session:
    async with session.get(url) as response:
        print(f"Headers:")
        pprint(dict(response.headers))
        data = await response.json()
        print(f"\nJSON Body:")
        print(f"type(data): {type(data)}")
        pprint(data)
```

```bash
Headers:
{'Content-Length': '24',
 'Content-Type': 'application/json',
 'Date': 'Tue, 06 May 2025 00:02:57 GMT',
 'Server': 'uvicorn',
 'x-custom-header': 'FastAPI Rocks'}

JSON Body:
type(data): <class 'dict'>
{'message': 'Header set'}
```

## *Using Request and Response Together*

Combining both `Request` and `Response` allows for complete control over the full request-response lifecycle:

```python
@router.post("/request&response/case4")
async def echo(request: Request, response: Response):
    data = await request.json()
    response.headers["X-Echoed"] = "True"
    result = {
        "received": data
    }

    return result
```

```python
url = "http://127.0.0.1:7249/ds2man/basic/request&response/case4"
payload = {
    "key1": "value1", 
    "key2": "value2"
}
async with aiohttp.ClientSession(
    trust_env=True, timeout=aiohttp.ClientTimeout(total=120)
) as session:
    async with session.post(url, json=payload) as response:
        print(f"Headers:")
        pprint(dict(response.headers))
        data = await response.json()
        print(f"\nJSON Body:")
        print(f"type(data): {type(data)}")
        pprint(data)
```

```bash
Headers:
{'Content-Length': '46',
 'Content-Type': 'application/json',
 'Date': 'Tue, 06 May 2025 00:08:40 GMT',
 'Server': 'uvicorn',
 'x-echoed': 'True'}

JSON Body:
type(data): <class 'dict'>
{'received': {'key1': 'value1', 'key2': 'value2'}}
```

## *Summary*

|Feature|`Request`|`Response`|
|---|---|---|
|Origin|`starlette.requests.Request`|`starlette.responses.Response`|
|Use case|Access request data from client|Customize what is sent to client|
|Typical fields|`.method`, `.headers`, `.body()`|`.headers`, `.set_cookie()`, etc.|
|Customizable|Yes (headers, body, method, etc.)|Yes (headers, cookies, status code)|